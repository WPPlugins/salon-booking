scheduler.config.limit_start=null,scheduler.config.limit_end=null,scheduler.config.limit_view=!1,scheduler.config.check_limits=!0,scheduler.config.mark_now=!0,scheduler.config.display_marked_timespans=!0,function(){var e=null,t="dhx_time_block",r=function(e,t,r){return t instanceof Date&&r instanceof Date?(e.start_date=t,e.end_date=r):(e.days=t,e.zones=r),e},a=function(e,a,s){var n="object"==typeof e?e:{days:e};return n.type=t,n.css="",a&&(s&&(n.sections=s),n=r(n,e,a)),n};scheduler.blockTime=function(e,t,r){var s=a(e,t,r);return scheduler.addMarkedTimespan(s)},scheduler.unblockTime=function(e,t,r){t=t||"fullday";var s=a(e,t,r);return scheduler.deleteMarkedTimespan(s)},scheduler.attachEvent("onBeforeViewChange",function(e,t,r,a){return a=a||t,r=r||e,scheduler.config.limit_view&&(a.valueOf()>scheduler.config.limit_end.valueOf()||this.date.add(a,1,r)<=scheduler.config.limit_start.valueOf())?(setTimeout(function(){scheduler.setCurrentView(scheduler._date,r)},1),!1):!0});var s=function(e,r,a){var s=a[r]&&a[r][t]?a[r][t]:a[e]&&a[e][t]?a[e][t]:[];return s},n=function(e){if(!e)return!0;if(!scheduler.config.check_limits)return!0;var t=scheduler,r=t._mode,a=scheduler._marked_timespans,n=t.config,d=[];d=e.rec_type?scheduler.getRecDates(e):[e];for(var i=!0,_=0;_<d.length;_++){var l=d[_];if(l._timed=scheduler.is_one_day_event(l),i=n.limit_start&&n.limit_end?l.start_date.valueOf()>=n.limit_start.valueOf()&&l.end_date.valueOf()<=n.limit_end.valueOf():!0)for(var o=new Date(l.start_date.valueOf()),h=scheduler.date.add(o,1,"day");o<l.end_date;o=scheduler.date.date_part(h),h=t.date.add(o,1,"day")){var u=+scheduler.date.date_part(new Date(o)),c=o.getDay(),f=[];if(t._props&&t._props[r]){var p=t._props[r],m=a[r];if(m&&m[l[p.map_to]])for(var v=m[l[p.map_to]],g=s(c,u,v),y=0;y<g.length;y++)f=scheduler._add_timespan_zones(f,g[y].zones)}if(t.matrix&&t.matrix[r]){var k=t.matrix[r],w=a[r];if(w&&w[l[k.y_property]])for(var z=w[l[k.y_property]],b=s(c,u,z),y=0;y<b.length;y++)f=scheduler._add_timespan_zones(f,b[y].zones)}for(var D=a.global,x=s(c,u,D),y=0;y<x.length;y++)f=scheduler._add_timespan_zones(f,x[y].zones);if(f)for(var y=0;y<f.length;y+=2){var E=scheduler._get_zone_minutes(o),O=l.end_date>h||l.end_date.getDate()!=o.getDate()?1440:scheduler._get_zone_minutes(l.end_date),M=f[y],C=f[y+1];if(O>M&&C>E){if(C>=E&&E>=M){if(1440==C||C>O){i=!1;break}if(!l._timed||!t._drag_id||"new-size"!=t._drag_mode){i=!1;break}l.start_date.setHours(0),l.start_date.setMinutes(C)}if(O>=M&&C>O||M>E&&O>C){if(!l._timed||!t._drag_id||"new-size"!=t._drag_mode){i=!1;break}l.end_date.setHours(0),l.end_date.setMinutes(M)}}}}i||(t._drag_id=null,t._drag_mode=null,i=t.checkEvent("onLimitViolation")?t.callEvent("onLimitViolation",[l.id,l]):i)}return i};scheduler.attachEvent("onMouseDown",function(e){return!(e=t)}),scheduler.attachEvent("onBeforeDrag",function(e){return e?n(scheduler.getEvent(e)):!0}),scheduler.attachEvent("onClick",function(e){return n(scheduler.getEvent(e))}),scheduler.attachEvent("onBeforeLightbox",function(t){var r=scheduler.getEvent(t);return e=[r.start_date,r.end_date],n(r)}),scheduler.attachEvent("onEventSave",function(e,t){if(t.rec_type){var r=scheduler._lame_clone(t);return scheduler._roll_back_dates(r),n(t)}return n(t)}),scheduler.attachEvent("onEventAdded",function(e){if(!e)return!0;var t=scheduler.getEvent(e);return!n(t)&&scheduler.config.limit_start&&scheduler.config.limit_end&&(t.start_date<scheduler.config.limit_start&&(t.start_date=new Date(scheduler.config.limit_start)),t.start_date.valueOf()>=scheduler.config.limit_end.valueOf()&&(t.start_date=this.date.add(scheduler.config.limit_end,-1,"day")),t.end_date<scheduler.config.limit_start&&(t.end_date=new Date(scheduler.config.limit_start)),t.end_date.valueOf()>=scheduler.config.limit_end.valueOf()&&(t.end_date=this.date.add(scheduler.config.limit_end,-1,"day")),t.start_date.valueOf()>=t.end_date.valueOf()&&(t.end_date=this.date.add(t.start_date,this.config.event_duration||this.config.time_step,"minute")),t._timed=this.is_one_day_event(t)),!0}),scheduler.attachEvent("onEventChanged",function(t){if(!t)return!0;var r=scheduler.getEvent(t);if(!n(r)){if(!e)return!1;r.start_date=e[0],r.end_date=e[1],r._timed=this.is_one_day_event(r)}return!0}),scheduler.attachEvent("onBeforeEventChanged",function(e){return n(e)}),scheduler.attachEvent("onBeforeEventCreated",function(e){var t=scheduler.getActionData(e).date,r={_timed:!0,start_date:t,end_date:scheduler.date.add(t,scheduler.config.time_step,"minute")};return n(r)}),scheduler.attachEvent("onViewChange",function(){scheduler.markNow()}),scheduler.attachEvent("onSchedulerResize",function(){return window.setTimeout(function(){scheduler.markNow()},1),!0}),scheduler.attachEvent("onTemplatesReady",function(){scheduler._mark_now_timer=window.setInterval(function(){scheduler.markNow()},6e4)}),scheduler.markNow=function(e){var t="dhx_now_time";this._els[t]||(this._els[t]=[]);var r=scheduler._currentDate(),a=this.config;if(scheduler._remove_mark_now(),!e&&a.mark_now&&r<this._max_date&&r>this._min_date&&r.getHours()>=a.first_hour&&r.getHours()<a.last_hour){var s=this.locate_holder_day(r);this._els[t]=scheduler._append_mark_now(s,r)}},scheduler._append_mark_now=function(e,t){var r="dhx_now_time",a=scheduler._get_zone_minutes(t),s={zones:[a,a+1],css:r,type:r};if(!this._table_view){if(this._props&&this._props[this._mode]){for(var n=this._els.dhx_cal_data[0].childNodes,d=[],i=0;i<n.length-1;i++){var _=e+i;s.days=_;var l=scheduler._render_marked_timespan(s,null,_)[0];d.push(l)}return d}return s.days=e,scheduler._render_marked_timespan(s,null,e)}return"month"==this._mode?(s.days=+scheduler.date.date_part(t),scheduler._render_marked_timespan(s,null,null)):void 0},scheduler._remove_mark_now=function(){for(var e="dhx_now_time",t=this._els[e],r=0;r<t.length;r++){var a=t[r],s=a.parentNode;s&&s.removeChild(a)}this._els[e]=[]},scheduler._marked_timespans={global:{}},scheduler._get_zone_minutes=function(e){return 60*e.getHours()+e.getMinutes()},scheduler._prepare_timespan_options=function(e){var t=[],r=[];if("fullweek"==e.days&&(e.days=[0,1,2,3,4,5,6]),e.days instanceof Array){for(var a=e.days.slice(),s=0;s<a.length;s++){var n=scheduler._lame_clone(e);n.days=a[s],t.push.apply(t,scheduler._prepare_timespan_options(n))}return t}if(!e||!(e.start_date&&e.end_date&&e.end_date>e.start_date||void 0!==e.days&&e.zones))return t;var d=0,i=1440;"fullday"==e.zones&&(e.zones=[d,i]),e.zones&&e.invert_zones&&(e.zones=scheduler.invertZones(e.zones)),e.id=scheduler.uid(),e.css=e.css||"",e.type=e.type||"default";var _=e.sections;if(_){for(var l in _)if(_.hasOwnProperty(l)){var o=_[l];o instanceof Array||(o=[o]);for(var s=0;s<o.length;s++){var h=scheduler._lame_copy({},e);h.sections={},h.sections[l]=o[s],r.push(h)}}}else r.push(e);for(var u=0;u<r.length;u++){var c=r[u],f=c.start_date,p=c.end_date;if(f&&p)for(var m=scheduler.date.date_part(new Date(f)),v=scheduler.date.add(m,1,"day");p>m;){var h=scheduler._lame_copy({},c);if(delete h.start_date,delete h.end_date,h.days=m.valueOf(),this.config.last_hour_48>2400){var g=f>m?scheduler._get_zone_minutes(f):d,y=p>v||p.getDate()!=m.getDate()?i+scheduler._get_zone_minutes(p):scheduler._get_zone_minutes(p),k=f.getHours();k<this.config.first_hour&&(g+=1440,y+=1440),h.zones=[g,y],t.push(h),m=v,v=scheduler.date.add(v,1,"day");break}var g=f>m?scheduler._get_zone_minutes(f):d,y=p>v||p.getDate()!=m.getDate()?i:scheduler._get_zone_minutes(p);h.zones=[g,y],t.push(h),m=v,v=scheduler.date.add(v,1,"day")}else c.days instanceof Date&&(c.days=scheduler.date.date_part(c.days).valueOf()),c.zones=e.zones.slice(),t.push(c)}return t},scheduler._get_dates_by_index=function(e,t,r){var a=[];t=scheduler.date.date_part(new Date(t||scheduler._min_date)),r=new Date(r||scheduler._max_date);for(var s=t.getDay(),n=e-s>=0?e-s:7-t.getDay()+e,d=scheduler.date.add(t,n,"day");r>d;d=scheduler.date.add(d,1,"week"))a.push(d);return a},scheduler._get_css_classes_by_config=function(e){var r=[];return e.type==t&&(r.push(t),e.css&&r.push(t+"_reset")),r.push("dhx_marked_timespan",e.css),r.join(" ")},scheduler._get_block_by_config=function(e){var t=document.createElement("DIV");return e.html&&("string"==typeof e.html?t.innerHTML=e.html:t.appendChild(e.html)),t},scheduler._render_marked_timespan=function(e,t,r){var a=[],s=scheduler.config,n=this._min_date,d=this._max_date,i=!1;if(!s.display_marked_timespans)return a;if(!r&&0!==r){if(e.days<7)r=e.days;else{var _=new Date(e.days);if(i=+_,!(+d>=+_&&+_>=+n))return a;r=_.getDay()}var l=n.getDay();l>r?r=7-(l-r):r-=l}var o=e.zones,h=scheduler._get_css_classes_by_config(e);if(scheduler._table_view&&"month"==scheduler._mode){var u=[],c=[];if(t)u.push(t),c.push(r);else{c=i?[i]:scheduler._get_dates_by_index(r);for(var f=0;f<c.length;f++)u.push(this._scales[c[f]])}for(var f=0;f<u.length;f++){t=u[f],r=c[f];for(var p=0;p<o.length;p+=2){var m=o[f],v=o[f+1];if(m>=v)return[];var g=scheduler._get_block_by_config(e);g.className=h;var y=t.offsetHeight-1,k=t.offsetWidth-1,w=(Math.floor((this._correct_shift(r,1)-n.valueOf())/(864e5*this._cols.length)),this.locate_holder_day(r,!1)%this._cols.length),z=(this._colsS[w],this.xy.month_scale_height+2);g.style.top=z+"px",g.style.lineHeight=g.style.height=y+"px",this.config.last_hour_48>2400?g.style.width=k+"px":g.style.width=Math.round((1440-m)/1440*k)+"px",g.style.left="0px",t.appendChild(g),a.push(g)}}}else{var b=r;if(this._props&&this._props[this._mode]&&e.sections&&e.sections[this._mode]){var D=this._props[this._mode];b=D.order[e.sections[this._mode]],D.size&&b>D.position+D.size&&(b=0)}t=t?t:scheduler.locate_holder(b);for(var f=0;f<o.length;f+=2){var m=Math.max(o[f],60*s.first_hour),v=Math.min(o[f+1],60*s.last_hour);if(m>=v){if(f+2<o.length)continue;return[]}var g=scheduler._get_block_by_config(e);g.className=h;var x=24*this.config.hour_size_px+1,E=36e5;g.style.top=Math.round((60*m*1e3-this.config.first_hour*E)*this.config.hour_size_px/E)%x+"px","timeline"==scheduler._mode?g.style.lineHeight=g.style.height=t.style.height:g.style.lineHeight=g.style.height=Math.max(Math.round(60*(v-m)*1e3*this.config.hour_size_px/E)%x,1)+"px",t.appendChild(g),a.push(g)}}return a},scheduler.markTimespan=function(e){var t=scheduler._prepare_timespan_options(e);if(t.length){for(var r=[],a=0;a<t.length;a++){var s=t[a],n=scheduler._render_marked_timespan(s,null,null);n.length&&r.push.apply(r,n)}return r}},scheduler.unmarkTimespan=function(e){if(e)for(var t=0;t<e.length;t++){var r=e[t];r.parentNode&&r.parentNode.removeChild(r)}},scheduler._marked_timespans_ids={},scheduler.addMarkedTimespan=function(e){var t=scheduler._prepare_timespan_options(e),r="global";if(t.length){var a=t[0].id,s=scheduler._marked_timespans,n=scheduler._marked_timespans_ids;n[a]||(n[a]=[]);for(var d=0;d<t.length;d++){var i=t[d],_=i.days,l=(i.zones,i.css,i.sections),o=i.type;if(i.id=a,l){for(var h in l)if(l.hasOwnProperty(h)){s[h]||(s[h]={});var u=l[h],c=s[h];c[u]||(c[u]={}),c[u][_]||(c[u][_]={}),c[u][_][o]||(c[u][_][o]=[]);var f=c[u][_][o];i._array=f,f.push(i),n[a].push(i)}}else{s[r][_]||(s[r][_]={}),s[r][_][o]||(s[r][_][o]=[]);var f=s[r][_][o];i._array=f,f.push(i),n[a].push(i)}}return a}},scheduler._add_timespan_zones=function(e,t){var r=e.slice();if(t=t.slice(),!r.length)return t;for(var a=0;a<r.length;a+=2)for(var s=r[a],n=r[a+1],d=a+2==r.length,i=0;i<t.length;i+=2){var _=t[i],l=t[i+1];if(l>n&&n>=_||s>_&&l>=s)r[a]=Math.min(s,_),r[a+1]=Math.max(n,l),a-=2;else{if(!d)continue;var o=s>_?0:2;r.splice(a+o,0,_,l)}t.splice(i--,2);break}return r},scheduler._subtract_timespan_zones=function(e,t){for(var r=e.slice(),a=0;a<r.length;a+=2)for(var s=r[a],n=r[a+1],d=0;d<t.length;d+=2){var i=t[d],_=t[d+1];if(_>s&&n>i){var l=!1;s>=i&&_>=n&&r.splice(a,2),i>s&&(r.splice(a,2,s,i),l=!0),n>_&&r.splice(l?a+2:a,l?0:2,_,n),a-=2;break}}return r},scheduler.invertZones=function(e){return scheduler._subtract_timespan_zones([0,1440],e.slice())},scheduler._delete_marked_timespan_by_id=function(e){var t=scheduler._marked_timespans_ids[e];if(t)for(var r=0;r<t.length;r++)for(var a=t[r],s=a._array,n=0;n<s.length;n++)if(s[n]==a){s.splice(n,1);break}},scheduler._delete_marked_timespan_by_config=function(e){var t=scheduler._marked_timespans,r=e.sections,a=e.days,s=e.type||"default",n=[];if(r){for(var d in r)if(r.hasOwnProperty(d)&&t[d]){var i=r[d];t[d][i]&&t[d][i][a]&&t[d][i][a][s]&&(n=t[d][i][a][s])}}else t.global[a]&&t.global[a][s]&&(n=t.global[a][s]);for(var _=0;_<n.length;_++){var l=n[_],o=scheduler._subtract_timespan_zones(l.zones,e.zones);if(o.length)l.zones=o;else{n.splice(_,1),_--;for(var h=scheduler._marked_timespans_ids[l.id],u=0;u<h.length;u++)if(h[u]==l){h.splice(u,1);break}}}},scheduler.deleteMarkedTimespan=function(e){if(arguments.length||(scheduler._marked_timespans={global:{}},scheduler._marked_timespans_ids={}),"object"!=typeof e)scheduler._delete_marked_timespan_by_id(e);else for(var t=scheduler._prepare_timespan_options(e),r=0;r<t.length;r++){t[r];scheduler._delete_marked_timespan_by_config(t[r])}},scheduler._get_types_to_render=function(e,t){var r=e?e:{};for(var a in t||{})t.hasOwnProperty(a)&&(r[a]=t[a]);return r},scheduler._get_configs_to_render=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push.apply(t,e[r]);return t},scheduler.attachEvent("onScaleAdd",function(e,t){if(!scheduler._table_view||"month"==scheduler._mode){var r=t.getDay(),a=t.valueOf(),s=this._mode,n=scheduler._marked_timespans,d=[];if(this._props&&this._props[s]){var i=this._props[s],_=i.options,l=scheduler._get_unit_index(i,t),o=_[l];if(t=scheduler.date.date_part(new Date(this._date)),r=t.getDay(),a=t.valueOf(),n[s]&&n[s][o.key]){var h=n[s][o.key],u=scheduler._get_types_to_render(h[r],h[a]);d.push.apply(d,scheduler._get_configs_to_render(u))}}var c=n.global,f=c[a]||c[r];d.push.apply(d,scheduler._get_configs_to_render(f));for(var p=0;p<d.length;p++)scheduler._render_marked_timespan(d[p],e,t)}})}();