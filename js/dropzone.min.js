;(function(){function require(a,b,c){var d=require.resolve(a);if(null==d){c=c||a;b=b||'root';var e=new Error('Failed to require "'+c+'" from "'+b+'"');e.path=c;e.parent=b;e.require=true;throw e;}var f=require.modules[d];if(!f.exports){f.exports={};f.client=f.component=true;f.call(this,f.exports,require.relative(d),f)}return f.exports}require.modules={};require.aliases={};require.resolve=function(a){if(a.charAt(0)==='/')a=a.slice(1);var b=[a,a+'.js',a+'.json',a+'/index.js',a+'/index.json'];for(var i=0;i<b.length;i++){var a=b[i];if(require.modules.hasOwnProperty(a))return a;if(require.aliases.hasOwnProperty(a))return require.aliases[a]}};require.normalize=function(a,b){var c=[];if('.'!=b.charAt(0))return b;a=a.split('/');b=b.split('/');for(var i=0;i<b.length;++i){if('..'==b[i]){a.pop()}else if('.'!=b[i]&&''!=b[i]){c.push(b[i])}}return a.concat(c).join('/')};require.register=function(a,b){require.modules[a]=b};require.alias=function(a,b){if(!require.modules.hasOwnProperty(a)){throw new Error('Failed to alias "'+a+'", it does not exist');}require.aliases[b]=a};require.relative=function(d){var p=require.normalize(d,'..');function lastIndexOf(a,b){var i=a.length;while(i--){if(a[i]===b)return i}return-1}function localRequire(a){var b=localRequire.resolve(a);return require(b,d,a)}localRequire.resolve=function(a){var c=a.charAt(0);if('/'==c)return a.slice(1);if('.'==c)return require.normalize(p,a);var b=d.split('/');var i=lastIndexOf(b,'deps')+1;if(!i)i=0;a=b.slice(0,i+1).join('/')+'/deps/'+a;return a};localRequire.exists=function(a){return require.modules.hasOwnProperty(localRequire.resolve(a))};return localRequire};require.register("component-emitter/index.js",function(d,e,f){f.exports=Emitter;function Emitter(a){if(a)return mixin(a)};function mixin(a){for(var b in Emitter.prototype){a[b]=Emitter.prototype[b]}return a}Emitter.prototype.on=function(a,b){this._callbacks=this._callbacks||{};(this._callbacks[a]=this._callbacks[a]||[]).push(b);return this};Emitter.prototype.once=function(a,b){var c=this;this._callbacks=this._callbacks||{};function on(){c.off(a,on);b.apply(this,arguments)}b._off=on;this.on(a,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=function(a,b){this._callbacks=this._callbacks||{};var c=this._callbacks[a];if(!c)return this;if(1==arguments.length){delete this._callbacks[a];return this}var i=c.indexOf(b._off||b);if(~i)c.splice(i,1);return this};Emitter.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),callbacks=this._callbacks[a];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,b)}}return this};Emitter.prototype.listeners=function(a){this._callbacks=this._callbacks||{};return this._callbacks[a]||[]};Emitter.prototype.hasListeners=function(a){return!!this.listeners(a).length}});require.register("dropzone/index.js",function(a,b,c){c.exports=b("./lib/dropzone.js")});require.register("dropzone/lib/dropzone.js",function(k,l,m){(function(){var j,Em,camelize,contentLoaded,noop,without,__hasProp={}.hasOwnProperty,__extends=function(a,b){for(var c in b){if(__hasProp.call(b,c))a[c]=b[c]}function ctor(){this.constructor=a}ctor.prototype=b.prototype;a.prototype=new ctor();a.__super__=b.prototype;return a},__slice=[].slice;Em=typeof Emitter!=="undefined"&&Emitter!==null?Emitter:l("emitter");noop=function(){};j=(function(g){var h;__extends(j,g);j.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","selectedfiles","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded"];j.prototype.defaultOptions={url:null,method:"post",withCredentials:false,parallelUploads:2,uploadMultiple:false,maxFilesize:256,paramName:"file",createImageThumbnails:true,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,maxFiles:null,params:{},clickable:true,ignoreHiddenFiles:true,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:true,addRemoveLinks:false,previewsContainer:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MB). Max filesize: {{maxFilesize}}MB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can only upload {{maxFiles}} files.",accept:function(a,b){return b()},init:function(){return noop},forceFallback:false,fallback:function(){var a,messageElement,span,_i,_len,_ref;this.element.className=""+this.element.className+" dz-browser-not-supported";_ref=this.element.getElementsByTagName("div");for(_i=0,_len=_ref.length;_i<_len;_i++){a=_ref[_i];if(/(^| )dz-message($| )/.test(a.className)){messageElement=a;a.className="dz-message";continue}}if(!messageElement){messageElement=j.createElement("<div class=\"dz-message\"><span></span></div>");this.element.appendChild(messageElement)}span=messageElement.getElementsByTagName("span")[0];if(span){span.textContent=this.options.dictFallbackMessage}return this.element.appendChild(this.getFallbackForm())},resize:function(a){var b,srcRatio,trgRatio;b={srcX:0,srcY:0,srcWidth:a.width,srcHeight:a.height};srcRatio=a.width/a.height;trgRatio=this.options.thumbnailWidth/this.options.thumbnailHeight;if(a.height<this.options.thumbnailHeight||a.width<this.options.thumbnailWidth){b.trgHeight=b.srcHeight;b.trgWidth=b.srcWidth}else{if(srcRatio>trgRatio){b.srcHeight=a.height;b.srcWidth=b.srcHeight*trgRatio}else{b.srcWidth=a.width;b.srcHeight=b.srcWidth/trgRatio}}b.srcX=(a.width-b.srcWidth)/2;b.srcY=(a.height-b.srcHeight)/2;return b},drop:function(e){return this.element.classList.remove("dz-drag-hover")},dragstart:noop,dragend:function(e){return this.element.classList.remove("dz-drag-hover")},dragenter:function(e){return this.element.classList.add("dz-drag-hover")},dragover:function(e){return this.element.classList.add("dz-drag-hover")},dragleave:function(e){return this.element.classList.remove("dz-drag-hover")},selectedfiles:function(a){if(this.element===this.previewsContainer){return this.element.classList.add("dz-started")}},reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(a){var b=this;a.previewElement=j.createElement(this.options.previewTemplate);if(a.photo_id)a.previewElement.id=a.photo_id;if(!a.previewElement.classList.contains("ui-state-default"))a.previewElement.classList.add("ui-state-default");a.previewTemplate=a.previewElement;this.previewsContainer.appendChild(a.previewElement);a.previewElement.querySelector("[data-dz-name]").textContent=a.name;a.previewElement.querySelector("[data-dz-size]").innerHTML=this.filesize(a.size);if(this.options.addRemoveLinks){a._removeLink=j.createElement("<a class=\"dz-remove\" href=\"javascript:undefined;\">"+this.options.dictRemoveFile+"</a>");a._removeLink.addEventListener("click",function(e){e.preventDefault();e.stopPropagation();if(a.status===j.UPLOADING){return j.confirm(b.options.dictCancelUploadConfirmation,function(){return b.removeFile(a)})}else{if(b.options.dictRemoveFileConfirmation){return j.confirm(b.options.dictRemoveFileConfirmation,function(){return b.removeFile(a)})}else{return b.removeFile(a)}}});a.previewElement.appendChild(a._removeLink)}return this._updateMaxFilesReachedClass()},removedfile:function(a){var b;if((b=a.previewElement)!=null){b.parentNode.removeChild(a.previewElement)}return this._updateMaxFilesReachedClass()},thumbnail:function(a,b,c){var d;a.previewElement.classList.remove("dz-file-preview");a.previewElement.classList.add("dz-image-preview");d=a.previewElement.querySelector("[data-dz-thumbnail]");d.src=b;if(c){var e=document.createElement("a");e.href=c;e.classList.add("lightbox");var f=document.createElement("img");f.src=b;e.appendChild(f);var p=d.parentNode;p.replaceChild(e,d)}return true},error:function(a,b){a.previewElement.classList.add("dz-error");return a.previewElement.querySelector("[data-dz-errormessage]").textContent=b},errormultiple:noop,processing:function(a){a.previewElement.classList.add("dz-processing");if(a._removeLink){return a._removeLink.textContent=this.options.dictCancelUpload}},processingmultiple:noop,uploadprogress:function(a,b,c){return a.previewElement.querySelector("[data-dz-uploadprogress]").style.width=""+b+"%"},totaluploadprogress:noop,sending:noop,sendingmultiple:noop,success:function(a){return a.previewElement.classList.add("dz-success")},successmultiple:noop,canceled:function(a){return this.emit("error",a,"Upload canceled.")},canceledmultiple:noop,complete:function(a){if(a._removeLink){return a._removeLink.textContent=this.options.dictRemoveFile}},completemultiple:noop,maxfilesexceeded:noop,previewTemplate:"<div class=\"dz-preview dz-file-preview\">\n  <div class=\"dz-details\">\n    <div class=\"dz-filename\"><span data-dz-name></span></div>\n    <div class=\"dz-size\" data-dz-size></div>\n    <img data-dz-thumbnail />\n  </div>\n  <div class=\"dz-progress\"><span class=\"dz-upload\" data-dz-uploadprogress></span></div>\n  <div class=\"dz-success-mark\"><span>✔</span></div>\n  <div class=\"dz-error-mark\"><span>✘</span></div>\n  <div class=\"dz-error-message\"><span data-dz-errormessage></span></div>\n</div>"};h=function(){var a,object,objects,target,val,_i,_len;target=arguments[0],objects=2<=arguments.length?__slice.call(arguments,1):[];for(_i=0,_len=objects.length;_i<_len;_i++){object=objects[_i];for(a in object){val=object[a];target[a]=val}}return target};function j(a,b){var c,fallback,_ref;this.element=a;this.version=j.version;this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,"");this.clickableElements=[];this.listeners=[];this.files=[];if(typeof this.element==="string"){this.element=document.querySelector(this.element)}if(!(this.element&&(this.element.nodeType!=null))){throw new Error("Invalid dropzone element.");}if(this.element.dropzone){throw new Error("Dropzone already attached.");}j.instances.push(this);a.dropzone=this;c=(_ref=j.optionsForElement(this.element))!=null?_ref:{};this.options=h({},this.defaultOptions,c,b!=null?b:{});if(this.options.forceFallback||!j.isBrowserSupported()){return this.options.fallback.call(this)}if(this.options.url==null){this.options.url=this.element.getAttribute("action")}if(!this.options.url){throw new Error("No URL provided.");}if(this.options.acceptedFiles&&this.options.acceptedMimeTypes){throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");}if(this.options.acceptedMimeTypes){this.options.acceptedFiles=this.options.acceptedMimeTypes;delete this.options.acceptedMimeTypes}this.options.method=this.options.method.toUpperCase();if((fallback=this.getExistingFallback())&&fallback.parentNode){fallback.parentNode.removeChild(fallback)}if(this.options.previewsContainer){this.previewsContainer=j.getElement(this.options.previewsContainer,"previewsContainer")}else{this.previewsContainer=this.element}if(this.options.clickable){if(this.options.clickable===true){this.clickableElements=[this.element]}else{this.clickableElements=j.getElements(this.options.clickable,"clickable")}}this.init()}j.prototype.getAcceptedFiles=function(){var a,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){a=_ref[_i];if(a.accepted){_results.push(a)}}return _results};j.prototype.getRejectedFiles=function(){var a,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){a=_ref[_i];if(!a.accepted){_results.push(a)}}return _results};j.prototype.getQueuedFiles=function(){var a,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){a=_ref[_i];if(a.status===j.QUEUED){_results.push(a)}}return _results};j.prototype.getUploadingFiles=function(){var a,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){a=_ref[_i];if(a.status===j.UPLOADING){_results.push(a)}}return _results};j.prototype.init=function(){var c,noPropagation,setupHiddenFileInput,_i,_len,_ref,_ref1,_this=this;if(this.element.tagName==="form"){this.element.setAttribute("enctype","multipart/form-data")}if(this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")){this.element.appendChild(j.createElement("<div class=\"dz-default dz-message\"><span>"+this.options.dictDefaultMessage+"</span></div>"))}if(this.clickableElements.length){setupHiddenFileInput=function(){if(_this.hiddenFileInput){document.body.removeChild(_this.hiddenFileInput)}_this.hiddenFileInput=document.createElement("input");_this.hiddenFileInput.setAttribute("type","file");_this.hiddenFileInput.setAttribute("multiple","multiple");if(_this.options.acceptedFiles!=null){_this.hiddenFileInput.setAttribute("accept",_this.options.acceptedFiles)}_this.hiddenFileInput.style.visibility="hidden";_this.hiddenFileInput.style.position="absolute";_this.hiddenFileInput.style.top="0";_this.hiddenFileInput.style.left="0";_this.hiddenFileInput.style.height="0";_this.hiddenFileInput.style.width="0";document.body.appendChild(_this.hiddenFileInput);return _this.hiddenFileInput.addEventListener("change",function(){var a;a=_this.hiddenFileInput.files;if(a.length){_this.emit("selectedfiles",a);_this.handleFiles(a)}return setupHiddenFileInput()})};setupHiddenFileInput()}this.URL=(_ref=window.URL)!=null?_ref:window.webkitURL;_ref1=this.events;for(_i=0,_len=_ref1.length;_i<_len;_i++){c=_ref1[_i];this.on(c,this.options[c])}this.on("uploadprogress",function(){return _this.updateTotalUploadProgress()});this.on("removedfile",function(){return _this.updateTotalUploadProgress()});this.on("canceled",function(a){return _this.emit("complete",a)});noPropagation=function(e){e.stopPropagation();if(e.preventDefault){return e.preventDefault()}else{return e.returnValue=false}};this.listeners=[{element:this.element,events:{"dragstart":function(e){return _this.emit("dragstart",e)},"dragenter":function(e){noPropagation(e);return _this.emit("dragenter",e)},"dragover":function(e){noPropagation(e);return _this.emit("dragover",e)},"dragleave":function(e){return _this.emit("dragleave",e)},"drop":function(e){noPropagation(e);return _this.drop(e)},"dragend":function(e){return _this.emit("dragend",e)}}}];this.clickableElements.forEach(function(b){return _this.listeners.push({element:b,events:{"click":function(a){if((b!==_this.element)||(a.target===_this.element||j.elementInside(a.target,_this.element.querySelector(".dz-message")))){return _this.hiddenFileInput.click()}}}})});this.enable();return this.options.init.call(this)};j.prototype.destroy=function(){var a;this.disable();this.removeAllFiles(true);if((a=this.hiddenFileInput)!=null?a.parentNode:void 0){this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput);this.hiddenFileInput=null}return delete this.element.dropzone};j.prototype.updateTotalUploadProgress=function(){var a,file,totalBytes,totalBytesSent,totalUploadProgress,_i,_len,_ref;totalBytesSent=0;totalBytes=0;a=this.getAcceptedFiles();if(a.length){_ref=this.getAcceptedFiles();for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];totalBytesSent+=file.upload.bytesSent;totalBytes+=file.upload.total}totalUploadProgress=100*totalBytesSent/totalBytes}else{totalUploadProgress=100}return this.emit("totaluploadprogress",totalUploadProgress,totalBytes,totalBytesSent)};j.prototype.getFallbackForm=function(){var a,fields,fieldsString,form;if(a=this.getExistingFallback()){return a}fieldsString="<div class=\"dz-fallback\">";if(this.options.dictFallbackText){fieldsString+="<p>"+this.options.dictFallbackText+"</p>"}fieldsString+="<input type=\"file\" name=\""+this.options.paramName+(this.options.uploadMultiple?"[]":"")+"\" "+(this.options.uploadMultiple?'multiple="multiple"':void 0)+" /><button type=\"submit\">Upload!</button></div>";fields=j.createElement(fieldsString);if(this.element.tagName!=="FORM"){form=j.createElement("<form action=\""+this.options.url+"\" enctype=\"multipart/form-data\" method=\""+this.options.method+"\"></form>");form.appendChild(fields)}else{this.element.setAttribute("enctype","multipart/form-data");this.element.setAttribute("method",this.options.method)}return form!=null?form:fields};j.prototype.getExistingFallback=function(){var c,getFallback,tagName,_i,_len,_ref;getFallback=function(a){var b,_i,_len;for(_i=0,_len=a.length;_i<_len;_i++){b=a[_i];if(/(^| )fallback($| )/.test(b.className)){return b}}};_ref=["div","form"];for(_i=0,_len=_ref.length;_i<_len;_i++){tagName=_ref[_i];if(c=getFallback(this.element.getElementsByTagName(tagName))){return c}}};j.prototype.setupEventListeners=function(){var b,event,listener,_i,_len,_ref,_results;_ref=this.listeners;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){b=_ref[_i];_results.push((function(){var a,_results1;a=b.events;_results1=[];for(event in a){listener=a[event];_results1.push(b.element.addEventListener(event,listener,false))}return _results1})())}return _results};j.prototype.removeEventListeners=function(){var b,event,listener,_i,_len,_ref,_results;_ref=this.listeners;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){b=_ref[_i];_results.push((function(){var a,_results1;a=b.events;_results1=[];for(event in a){listener=a[event];_results1.push(b.element.removeEventListener(event,listener,false))}return _results1})())}return _results};j.prototype.disable=function(){var b,_i,_len,_ref,_results;this.clickableElements.forEach(function(a){return a.classList.remove("dz-clickable")});this.removeEventListeners();_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){b=_ref[_i];_results.push(this.cancelUpload(b))}return _results};j.prototype.enable=function(){this.clickableElements.forEach(function(a){return a.classList.add("dz-clickable")});return this.setupEventListeners()};j.prototype.filesize=function(a){var b;if(a>=100000000000){a=a/100000000000;b="TB"}else if(a>=100000000){a=a/100000000;b="GB"}else if(a>=100000){a=a/100000;b="MB"}else if(a>=100){a=a/100;b="KB"}else{a=a*10;b="b"}return"<strong>"+(Math.round(a)/10)+"</strong> "+b};j.prototype._updateMaxFilesReachedClass=function(){if(this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles){return this.element.classList.add("dz-max-files-reached")}else{return this.element.classList.remove("dz-max-files-reached")}};j.prototype.drop=function(e){var a,items;if(!e.dataTransfer){return}this.emit("drop",e);a=e.dataTransfer.files;this.emit("selectedfiles",a);if(a.length){items=e.dataTransfer.items;if(items&&items.length&&((items[0].webkitGetAsEntry!=null)||(items[0].getAsEntry!=null))){this.handleItems(items)}else{this.handleFiles(a)}}};j.prototype.handleFiles=function(a){var b,_i,_len,_results;_results=[];for(_i=0,_len=a.length;_i<_len;_i++){b=a[_i];_results.push(this.addFile(b))}return _results};j.prototype.handleItems=function(a){var b,item,_i,_len;for(_i=0,_len=a.length;_i<_len;_i++){item=a[_i];if(item.webkitGetAsEntry!=null){b=item.webkitGetAsEntry();if(b.isFile){this.addFile(item.getAsFile())}else if(b.isDirectory){this.addDirectory(b,b.name)}}else{this.addFile(item.getAsFile())}}};j.prototype.accept=function(a,b){if(a.size>this.options.maxFilesize*1024*1024){return b(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(a.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize))}else if(!j.isValidFile(a,this.options.acceptedFiles)){return b(this.options.dictInvalidFileType)}else if(this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles){b(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles));return this.emit("maxfilesexceeded",a)}else{return this.options.accept.call(this,a,b)}};j.prototype.addFile=function(b){var c=this;b.upload={progress:0,total:b.size,bytesSent:0};this.files.push(b);b.status=j.ADDED;this.emit("addedfile",b);if(this.options.createImageThumbnails&&b.type.match(/image.*/)&&b.size<=this.options.maxThumbnailFilesize*1024*1024){this.createThumbnail(b)}return this.accept(b,function(a){if(a){b.accepted=false;return c._errorProcessing([b],a)}else{return c.enqueueFile(b)}})};j.prototype.enqueueFiles=function(a){var b,_i,_len;for(_i=0,_len=a.length;_i<_len;_i++){b=a[_i];this.enqueueFile(b)}return null};j.prototype.enqueueFile=function(a){var b=this;a.accepted=true;if(a.status===j.ADDED){a.status=j.QUEUED;if(this.options.autoProcessQueue){return setTimeout((function(){return b.processQueue()}),1)}}else{throw new Error("This file can't be queued because it has already been processed or was rejected.");}};j.prototype.addDirectory=function(d,e){var f,entriesReader,_this=this;f=d.createReader();entriesReader=function(b){var c,_len;for(c=0,_len=b.length;c<_len;c++){d=b[c];if(d.isFile){d.file(function(a){if(_this.options.ignoreHiddenFiles&&a.name.substring(0,1)==='.'){return}a.fullPath=""+e+"/"+a.name;return _this.addFile(a)})}else if(d.isDirectory){_this.addDirectory(d,""+e+"/"+d.name)}}};return f.readEntries(entriesReader,function(a){return typeof console!=="undefined"&&console!==null?typeof console.log==="function"?console.log(a):void 0:void 0})};j.prototype.removeFile=function(a){if(a.status===j.UPLOADING){this.cancelUpload(a)}this.files=without(this.files,a);this.emit("removedfile",a);if(this.files.length===0){return this.emit("reset")}};j.prototype.removeAllFiles=function(a){var b,_i,_len,_ref;if(a==null){a=false}_ref=this.files.slice();for(_i=0,_len=_ref.length;_i<_len;_i++){b=_ref[_i];if(b.status!==j.UPLOADING||a){this.removeFile(b)}}return null};j.prototype.createThumbnail=function(c){var d,_this=this;d=new FileReader;d.onload=function(){var b;b=new Image;b.onload=function(){var a,ctx,resizeInfo,thumbnail,_ref,_ref1,_ref2,_ref3;c.width=b.width;c.height=b.height;resizeInfo=_this.options.resize.call(_this,c);if(resizeInfo.trgWidth==null){resizeInfo.trgWidth=_this.options.thumbnailWidth}if(resizeInfo.trgHeight==null){resizeInfo.trgHeight=_this.options.thumbnailHeight}a=document.createElement("canvas");ctx=a.getContext("2d");a.width=resizeInfo.trgWidth;a.height=resizeInfo.trgHeight;ctx.drawImage(b,(_ref=resizeInfo.srcX)!=null?_ref:0,(_ref1=resizeInfo.srcY)!=null?_ref1:0,resizeInfo.srcWidth,resizeInfo.srcHeight,(_ref2=resizeInfo.trgX)!=null?_ref2:0,(_ref3=resizeInfo.trgY)!=null?_ref3:0,resizeInfo.trgWidth,resizeInfo.trgHeight);thumbnail=a.toDataURL("image/png");return _this.emit("thumbnail",c,thumbnail)};return b.src=d.result};return d.readAsDataURL(c)};j.prototype.processQueue=function(){var i,parallelUploads,processingLength,queuedFiles;parallelUploads=this.options.parallelUploads;processingLength=this.getUploadingFiles().length;i=processingLength;if(processingLength>=parallelUploads){return}queuedFiles=this.getQueuedFiles();if(!(queuedFiles.length>0)){return}if(this.options.uploadMultiple){return this.processFiles(queuedFiles.slice(0,parallelUploads-processingLength))}else{while(i<parallelUploads){if(!queuedFiles.length){return}this.processFile(queuedFiles.shift());i++}}};j.prototype.processFile=function(a){return this.processFiles([a])};j.prototype.processFiles=function(a){var b,_i,_len;for(_i=0,_len=a.length;_i<_len;_i++){b=a[_i];b.processing=true;b.status=j.UPLOADING;this.emit("processing",b)}if(this.options.uploadMultiple){this.emit("processingmultiple",a)}return this.uploadFiles(a)};j.prototype._getFilesWithXhr=function(b){var c,files;return files=(function(){var a,_len,_ref,_results;_ref=this.files;_results=[];for(a=0,_len=_ref.length;a<_len;a++){c=_ref[a];if(c.xhr===b){_results.push(c)}}return _results}).call(this)};j.prototype.cancelUpload=function(a){var b,groupedFiles,_i,_j,_len,_len1,_ref;if(a.status===j.UPLOADING){groupedFiles=this._getFilesWithXhr(a.xhr);for(_i=0,_len=groupedFiles.length;_i<_len;_i++){b=groupedFiles[_i];b.status=j.CANCELED}a.xhr.abort();for(_j=0,_len1=groupedFiles.length;_j<_len1;_j++){b=groupedFiles[_j];this.emit("canceled",b)}if(this.options.uploadMultiple){this.emit("canceledmultiple",groupedFiles)}}else if((_ref=a.status)===j.ADDED||_ref===j.QUEUED){a.status=j.CANCELED;this.emit("canceled",a);if(this.options.uploadMultiple){this.emit("canceledmultiple",[a])}}if(this.options.autoProcessQueue){return this.processQueue()}};j.prototype.uploadFile=function(a){return this.uploadFiles([a])};j.prototype.uploadFiles=function(b){var c,formData,handleError,headerName,headerValue,headers,input,inputName,inputType,key,progressObj,response,updateProgress,value,xhr,_i,_j,_k,_l,_len,_len1,_len2,_len3,_ref,_ref1,_ref2,_ref3,_this=this;xhr=new XMLHttpRequest();for(_i=0,_len=b.length;_i<_len;_i++){c=b[_i];c.xhr=xhr}xhr.open(this.options.method,this.options.url,true);xhr.withCredentials=!!this.options.withCredentials;response=null;handleError=function(){var a,_len1,_results;_results=[];for(a=0,_len1=b.length;a<_len1;a++){c=b[a];_results.push(_this._errorProcessing(b,response||_this.options.dictResponseError.replace("{{statusCode}}",xhr.status),xhr))}return _results};updateProgress=function(e){var a,progress,_j,_k,_l,_len1,_len2,_len3,_results;if(e!=null){progress=100*e.loaded/e.total;for(_j=0,_len1=b.length;_j<_len1;_j++){c=b[_j];c.upload={progress:progress,total:e.total,bytesSent:e.loaded}}}else{a=true;progress=100;for(_k=0,_len2=b.length;_k<_len2;_k++){c=b[_k];if(!(c.upload.progress===100&&c.upload.bytesSent===c.upload.total)){a=false}c.upload.progress=progress;c.upload.bytesSent=c.upload.total}if(a){return}}_results=[];for(_l=0,_len3=b.length;_l<_len3;_l++){c=b[_l];_results.push(_this.emit("uploadprogress",c,progress,c.upload.bytesSent))}return _results};xhr.onload=function(e){var a;if(b[0].status===j.CANCELED){return}if(xhr.readyState!==4){return}response=xhr.responseText;if(xhr.getResponseHeader("content-type")&&~xhr.getResponseHeader("content-type").indexOf("application/json")){try{response=JSON.parse(response)}catch(_error){e=_error;response="Invalid JSON response from server."}}updateProgress();if(!((200<=(a=xhr.status)&&a<300))){return handleError()}else{return _this._finished(b,response,e)}};xhr.onerror=function(){if(b[0].status===j.CANCELED){return}return handleError()};progressObj=(_ref=xhr.upload)!=null?_ref:xhr;progressObj.onprogress=updateProgress;headers={"Accept":"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};if(this.options.headers){h(headers,this.options.headers)}for(headerName in headers){headerValue=headers[headerName];xhr.setRequestHeader(headerName,headerValue)}formData=new FormData();if(this.options.params){_ref1=this.options.params;for(key in _ref1){value=_ref1[key];formData.append(key,value)}}for(_j=0,_len1=b.length;_j<_len1;_j++){c=b[_j];this.emit("sending",c,xhr,formData)}if(this.options.uploadMultiple){this.emit("sendingmultiple",b,xhr,formData)}if(this.element.tagName==="FORM"){_ref2=this.element.querySelectorAll("input, textarea, select, button");for(_k=0,_len2=_ref2.length;_k<_len2;_k++){input=_ref2[_k];inputName=input.getAttribute("name");inputType=input.getAttribute("type");if(!inputType||((_ref3=inputType.toLowerCase())!=="checkbox"&&_ref3!=="radio")||input.checked){formData.append(inputName,input.value)}}}for(_l=0,_len3=b.length;_l<_len3;_l++){c=b[_l];formData.append(""+this.options.paramName+(this.options.uploadMultiple?"[]":""),c,c.name)}return xhr.send(formData)};j.prototype._finished=function(a,b,e){var c,_i,_len;for(_i=0,_len=a.length;_i<_len;_i++){c=a[_i];c.status=j.SUCCESS;this.emit("success",c,b,e);this.emit("complete",c)}if(this.options.uploadMultiple){this.emit("successmultiple",a,b,e);this.emit("completemultiple",a)}if(this.options.autoProcessQueue){return this.processQueue()}};j.prototype._errorProcessing=function(a,b,c){var d,_i,_len;for(_i=0,_len=a.length;_i<_len;_i++){d=a[_i];d.status=j.ERROR;this.emit("error",d,b,c);this.emit("complete",d)}if(this.options.uploadMultiple){this.emit("errormultiple",a,b,c);this.emit("completemultiple",a)}if(this.options.autoProcessQueue){return this.processQueue()}};return j})(Em);j.version="3.7.1";j.options={};j.optionsForElement=function(a){if(a.id){return j.options[camelize(a.id)]}else{return void 0}};j.instances=[];j.forElement=function(a){if(typeof a==="string"){a=document.querySelector(a)}if((a!=null?a.dropzone:void 0)==null){throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");}return a.dropzone};j.autoDiscover=true;j.discover=function(){var c,dropzone,dropzones,_i,_len,_results;if(document.querySelectorAll){dropzones=document.querySelectorAll(".dropzone")}else{dropzones=[];c=function(a){var b,_i,_len,_results;_results=[];for(_i=0,_len=a.length;_i<_len;_i++){b=a[_i];if(/(^| )dropzone($| )/.test(b.className)){_results.push(dropzones.push(b))}else{_results.push(void 0)}}return _results};c(document.getElementsByTagName("div"));c(document.getElementsByTagName("form"))}_results=[];for(_i=0,_len=dropzones.length;_i<_len;_i++){dropzone=dropzones[_i];if(j.optionsForElement(dropzone)!==false){_results.push(new j(dropzone))}else{_results.push(void 0)}}return _results};j.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i];j.isBrowserSupported=function(){var a,regex,_i,_len,_ref;a=true;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector){if(!("classList"in document.createElement("a"))){a=false}else{_ref=j.blacklistedBrowsers;for(_i=0,_len=_ref.length;_i<_len;_i++){regex=_ref[_i];if(regex.test(navigator.userAgent)){a=false;continue}}}}else{a=false}return a};without=function(a,b){var c,_i,_len,_results;_results=[];for(_i=0,_len=a.length;_i<_len;_i++){c=a[_i];if(c!==b){_results.push(c)}}return _results};camelize=function(b){return b.replace(/[\-_](\w)/g,function(a){return a[1].toUpperCase()})};j.createElement=function(a){var b;b=document.createElement("div");b.innerHTML=a;return b.childNodes[0]};j.elementInside=function(a,b){if(a===b){return true}while(a=a.parentNode){if(a===b){return true}}return false};j.getElement=function(a,b){var c;if(typeof a==="string"){c=document.querySelector(a)}else if(a.nodeType!=null){c=a}if(c==null){throw new Error("Invalid `"+b+"` option provided. Please provide a CSS selector or a plain HTML element.");}return c};j.getElements=function(a,b){var e,el,elements,_i,_j,_len,_len1,_ref;if(a instanceof Array){elements=[];try{for(_i=0,_len=a.length;_i<_len;_i++){el=a[_i];elements.push(this.getElement(el,b))}}catch(_error){e=_error;elements=null}}else if(typeof a==="string"){elements=[];_ref=document.querySelectorAll(a);for(_j=0,_len1=_ref.length;_j<_len1;_j++){el=_ref[_j];elements.push(el)}}else if(a.nodeType!=null){elements=[a]}if(!((elements!=null)&&elements.length)){throw new Error("Invalid `"+b+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");}return elements};j.confirm=function(a,b,c){if(window.confirm(a)){return b()}else if(c!=null){return c()}};j.isValidFile=function(a,b){var c,mimeType,validType,_i,_len;if(!b){return true}b=b.split(",");mimeType=a.type;c=mimeType.replace(/\/.*$/,"");for(_i=0,_len=b.length;_i<_len;_i++){validType=b[_i];validType=validType.trim();if(validType.charAt(0)==="."){if(a.name.indexOf(validType,a.name.length-validType.length)!==-1){return true}}else if(/\/\*$/.test(validType)){if(c===validType.replace(/\/.*$/,"")){return true}}else{if(mimeType===validType){return true}}}return false};if(typeof jQuery!=="undefined"&&jQuery!==null){jQuery.fn.dropzone=function(a){return this.each(function(){return new j(this,a)})}}if(typeof m!=="undefined"&&m!==null){m.exports=j}else{window.Dropzone=j}j.ADDED="added";j.QUEUED="queued";j.ACCEPTED=j.QUEUED;j.UPLOADING="uploading";j.PROCESSING=j.UPLOADING;j.CANCELED="canceled";j.ERROR="error";j.SUCCESS="success";contentLoaded=function(a,b){var c,doc,done,init,poll,pre,rem,root,top;done=false;top=true;doc=a.document;root=doc.documentElement;c=(doc.addEventListener?"addEventListener":"attachEvent");rem=(doc.addEventListener?"removeEventListener":"detachEvent");pre=(doc.addEventListener?"":"on");init=function(e){if(e.type==="readystatechange"&&doc.readyState!=="complete"){return}(e.type==="load"?a:doc)[rem](pre+e.type,init,false);if(!done&&(done=true)){return b.call(a,e.type||e)}};poll=function(){var e;try{root.doScroll("left")}catch(_error){e=_error;setTimeout(poll,50);return}return init("poll")};if(doc.readyState!=="complete"){if(doc.createEventObject&&root.doScroll){try{top=!a.frameElement}catch(_error){}if(top){poll()}}doc[c](pre+"DOMContentLoaded",init,false);doc[c](pre+"readystatechange",init,false);return a[c](pre+"load",init,false)}};j._autoDiscoverFunction=function(){if(j.autoDiscover){return j.discover()}};contentLoaded(window,j._autoDiscoverFunction)}).call(this)});require.alias("component-emitter/index.js","dropzone/deps/emitter/index.js");require.alias("component-emitter/index.js","emitter/index.js");if(typeof exports=="object"){module.exports=require("dropzone")}else if(typeof define=="function"&&define.amd){define(function(){return require("dropzone")})}else{this["Dropzone"]=require("dropzone")}})();